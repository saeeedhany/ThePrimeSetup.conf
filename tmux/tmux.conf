# ~/.tmux.conf - Enhanced Tmux Configuration

##### GENERAL SETTINGS #####
set -g mouse on
set -g history-limit 50000
setw -g mode-keys vi
set -g base-index 1
setw -g pane-base-index 1
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc"
set -s escape-time 0
set -g focus-events on
set -g renumber-windows on
setw -g aggressive-resize on

##### PREFIX KEY #####
set -g prefix C-b
bind C-b send-prefix

##### TPM (TMUX PLUGIN MANAGER) #####
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'christoomey/vim-tmux-navigator'

##### STATUS BAR STYLING #####
set -g status on
set -g status-interval 5
set -g status-justify centre
set -g status-left-length 100
set -g status-right-length 100
set -g status-position bottom
set -g status-style "bg=#0F120E,fg=#CCC3B8"

set -g window-status-format " #[fg=#7A7373]#I:#W "
set -g window-status-current-format "#[bg=#93877C,fg=#0F120E,bold] #I:#W #[bg=#0F120E,fg=#93877C]"
set -g window-status-separator ""

set -g status-left "#[bg=#CCC3B8,fg=#0F120E,bold] 󰖲 #S #[bg=#0F120E,fg=#CCC3B8]#[fg=#93877C] 󰅂 #(whoami) "
set -g status-right "#[fg=#504F50] 󰃭 %a %d/%m #[fg=#7A7373] 󰥔 %H:%M #[fg=#CCC3B8,bg=#0F120E]#[bg=#CCC3B8,fg=#0F120E,bold] 󰌽 #h "

set -g pane-border-style "fg=#504F50"
set -g pane-active-border-style "fg=#93877C"

set -g message-style "bg=#93877C,fg=#0F120E,bold"
set -g message-command-style "bg=#504F50,fg=#CCC3B8"

set -g mode-style "bg=#93877C,fg=#0F120E"

set -g clock-mode-colour "#CCC3B8"
set -g clock-mode-style 24

setw -g window-status-activity-style "bg=#0F120E,fg=#93877C"
setw -g window-status-bell-style "bg=#7A7373,fg=#0F120E"

set -g display-panes-active-colour "#CCC3B8"
set -g display-panes-colour "#504F50"
set -g display-panes-time 2000

##### WINDOW AND PANE MANAGEMENT #####

# Split panes
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind _ split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# New window in current path
bind c new-window -c "#{pane_current_path}"

# Navigate panes (vim-style)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Quick pane resizing
bind -r C-h resize-pane -L 10
bind -r C-j resize-pane -D 10
bind -r C-k resize-pane -U 10
bind -r C-l resize-pane -R 10

# Swap panes
bind > swap-pane -D
bind < swap-pane -U

# Break pane into new window
bind b break-pane -d

# Join pane from another window
bind-key j command-prompt -p "join pane from:"  "join-pane -s '%%'"

# Navigate windows
bind -n M-h previous-window
bind -n M-l next-window
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

# Move windows
bind -r "<" swap-window -t -1 \; select-window -t -1
bind -r ">" swap-window -t +1 \; select-window -t +1

# Kill pane/window without confirmation
bind x kill-pane
bind X kill-window

# Toggle pane zoom
bind f resize-pane -Z

# Equalize panes
bind = select-layout tiled

##### SESSION MANAGEMENT #####

# Quick session switching
bind S choose-session
bind N command-prompt -p "New session name:" "new-session -s '%%'"

# Session navigation
bind -n M-s choose-session

##### COPY MODE (VI-STYLE) #####

bind v copy-mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi C-v send -X rectangle-toggle
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "xclip -selection clipboard -i"
bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel "xclip -selection clipboard -i"
bind -T copy-mode-vi Escape send -X cancel

# Paste
bind p paste-buffer

# Search
bind / copy-mode \; send-keys "/"
bind ? copy-mode \; send-keys "?"

##### QUICK COMMANDS #####

# Reload config
bind r source-file ~/.tmux.conf \; display-message "Config reloaded"

# Toggle status bar
bind t set-option status

# Clear history and screen
bind C-k send-keys -R \; send-keys C-l \; clear-history

# Synchronize panes
bind s setw synchronize-panes \; display-message "Sync #{?pane_synchronized,ON,OFF}"

##### LAYOUT PRESETS #####

bind M-1 select-layout even-horizontal
bind M-2 select-layout even-vertical
bind M-3 select-layout main-horizontal
bind M-4 select-layout main-vertical
bind M-5 select-layout tiled

##### PRODUCTIVITY FEATURES #####

# Quick command prompt
bind : command-prompt

# Rename window without prefix
bind , command-prompt -I "#W" "rename-window '%%'"

# Rename session
bind '$' command-prompt -I "#S" "rename-session '%%'"

# Last window
bind Tab last-window

# Last session
bind BTab switch-client -l

# Monitor activity
bind m setw monitor-activity \; display-message "Monitor activity #{?monitor-activity,ON,OFF}"

# Monitor silence
bind M command-prompt -p "Monitor silence (seconds):" "setw monitor-silence %%"

##### MOUSE ENHANCEMENTS #####

# Mouse drag to resize panes
bind -n MouseDrag1Border resize-pane -M

# Double click to select and copy word
bind -n DoubleClick1Pane select-pane \; copy-mode -M \; send -X select-word

# Triple click to select and copy line
bind -n TripleClick1Pane select-pane \; copy-mode -M \; send -X select-line

##### NOTIFICATIONS #####
set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
setw -g monitor-activity on
set -g bell-action none

##### PLUGIN SETTINGS #####

# Resurrect
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-strategy-vim 'session'
set -g @resurrect-strategy-nvim 'session'
set -g @resurrect-dir '~/.tmux/resurrect'

# Continuum
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# Yank
set -g @yank_selection 'clipboard'
set -g @yank_selection_mouse 'clipboard'

# Vim-tmux-navigator
set -g @vim_navigator_mapping_left "h"
set -g @vim_navigator_mapping_right "l"
set -g @vim_navigator_mapping_up "k"
set -g @vim_navigator_mapping_down "j"

##### PERFORMANCE OPTIMIZATIONS #####

# Faster command sequences
set -s escape-time 0

# Increase repeat timeout
set -g repeat-time 600

# Super useful when using sharing a session with different size terminals
setw -g aggressive-resize on

##### RUN TPM #####
run '~/.tmux/plugins/tpm/tpm'
